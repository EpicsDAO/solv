<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes</title><meta property="og:title" content="Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"/><meta name="twitter:title" content="Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"/><meta name="twitter:text:title" content="Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"/><meta name="description" content="In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."/><meta property="og:description" content="In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."/><meta name="twitter:description" content="In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."/><meta property="og:url" content="https://solv.epics.dev/en/doc/tutorial/chapter4"/><meta property="og:image" content="https://solv.epics.dev/ogp.png"/><meta property="og:image:secure" content="https://solv.epics.dev/ogp.png"/><meta name="twitter:image" content="https://solv.epics.dev/ogp.png"/><meta name="next-head-count" content="13"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><meta name="format-detection" content="telephone=no"/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><meta name="keywords" content="solv, Solana, Epics, DAO, Open-Source, Validator, RPC, Node, Ubuntu, Utility, Tool"/><meta property="og:type" content="website"/><meta property="og:site_name" content="solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"/><meta property="og:locale" content="en_US"/><meta http-equiv="content-language" content="en-us"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="@EpicsDAO2"/><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"/><link rel="preload" href="/_next/static/css/eafd365f16b35e04.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eafd365f16b35e04.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-87b3a303122f2f0d.js" defer=""></script><script src="/_next/static/chunks/framework-8b412534be3d083c.js" defer=""></script><script src="/_next/static/chunks/main-95fbeaa0239f7cc5.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fa35a254f8c9e6f1.js" defer=""></script><script src="/_next/static/chunks/9849d5b5-1dba8a65284812b4.js" defer=""></script><script src="/_next/static/chunks/634-cbf849f3ac2429ae.js" defer=""></script><script src="/_next/static/chunks/979-c080a50be3ca5ae9.js" defer=""></script><script src="/_next/static/chunks/782-76453d720f0fabf5.js" defer=""></script><script src="/_next/static/chunks/102-eab3258f32356b38.js" defer=""></script><script src="/_next/static/chunks/858-8cd0f679f68ca946.js" defer=""></script><script src="/_next/static/chunks/pages/%5Blocale%5D/doc/%5B...slug%5D-f1dc4a9103c8cb2a.js" defer=""></script><script src="/_next/static/Po52uJGQ0M3xsRHnuxKeM/_buildManifest.js" defer=""></script><script src="/_next/static/Po52uJGQ0M3xsRHnuxKeM/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><main class="min-h-screen scroll-smooth font-sans antialiased"><div class="min-h-screen"><div class="flex h-screen w-full -translate-y-12 items-center justify-center"><img alt="Loading..." loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="h-6 w-auto dark:hidden sm:h-10" style="color:transparent" src="/_next/static/media/3-dots-bounce.7262aa0b.svg"/><img alt="Loading..." loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="hidden h-6 w-auto dark:block sm:h-10" style="color:transparent" src="/_next/static/media/3-dots-bounce-white.2b50e184.svg"/></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà","description":"In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets.","content":"\nIn this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets. We cover the entire process from data collection to analysis and reporting, aiming for real-time performance tracking and faster decision-making. By combining Firestore‚Äôs powerful database capabilities with the accessibility of Google Spreadsheets, we achieve automation and optimization in revenue management. Through this chapter, you can gain not only technical knowledge but also effective data utilization methods.\n\n## üìù Creating Firestore Models\n\nAs it stands from the previous chapter, the scheduler will notify about duplicate data every time it checks. We will improve this by recording data in `Firestore` and only notifying when new data is added.\n\nWe will create two models called `Wallet` and `WalletStakeReward` as follows.\n\n`functions/skeet/src/models/walletModels.ts`\n\n```ts\nimport { Timestamp, FieldValue } from '@skeet-framework/firestore'\n\n// CollectionId: WalletPubkey\n// DocumentId: walletPubkey - e.g. LKnGHsjr7UYBXnzfbrz4k6QotCz56rMQTSiVwdRSyL9\n// Path: WalletPubkey\nexport const WalletPubkeyCN = 'WalletPubkey'\nexport const genWalletPubkeyPath = () =\u003e `${WalletPubkeyCN}`\nexport type WalletPubkey = {\n  id?: string\n  date: string\n  walletPubkey: string\n  totalSol: number\n  totalRewardAmount: number\n  createdAt?: Timestamp | FieldValue\n  updatedAt?: Timestamp | FieldValue\n}\n\n// CollectionId: StakeReward\n// DocumentId: epoch - e.g. 420\n// Path: StakeReward\nexport const StakeRewardCN = 'StakeReward'\nexport const genStakeRewardPath = (pubkey: string) =\u003e\n  `${WalletPubkeyCN}/${pubkey}/${StakeRewardCN}`\nexport type StakeReward = {\n  id?: string\n  date: string\n  walletPubkey: string\n  epoch: number\n  totalRewardAmount: number\n  totalBalance: number\n  createdAt?: Timestamp | FieldValue\n  updatedAt?: Timestamp | FieldValue\n}\n```\n\n## üìå Registering Managed Addresses\n\nTDS rewards are issued monthly to the `authority` account by staking accounts, but here we will use `@skeet-framework/solana-utils` to register the address of the `authority` account. By doing so, you can collectively check the rewards for the associated stake accounts.\n\nCreate a script in the following directory to register the pubkey of the managed wallet in Firestore. You can also enter data directly from the Firebase browser, so please add the data by any preferred method.\n\n`functions/skeet/src/script/addWallet.ts`\n\n```ts\nimport { Wallet, WalletCN } from '@/models/walletModels'\nimport { add } from '@skeet-framework/firestore'\nimport { format } from '@skeet-framework/utils'\nimport admin from 'firebase-admin'\nadmin.initializeApp()\nconst db = admin.firestore()\n\nexport const addWallet = async (pubkey: string) =\u003e {\n  const walletParams: Wallet = {\n    date: format(new Date(), 'yyyy-MM-dd'),\n    pubkey,\n    totalSol: 0,\n    totalRewardAmount: 0,\n  }\n  await add\u003cWallet\u003e(db, WalletCN, walletParams, pubkey)\n  console.log({ status: 'success' })\n}\n\nconst run = async () =\u003e {\n  const pubkey = 'your-authority-keypair'\n  await addWallet(pubkey)\n}\n\nrun()\n```\n\nMove to the `functions/skeet` directory and execute the script.\n\n```bash\ncd functions/skeet \u0026\u0026 npx ts-node -r tsconfig-paths/register --transpile-only src/scripts/addWallet.ts\n{ status: 'success' }\n```\n\nUpon checking Firebase's Firestore, the data has been successfully created üéâ\n\n![](https://storage.googleapis.com/epics-bucket/solv2/solv-wallet.png)\n\n## üîÑ Updating StakeMonitor\n\nLet's update `StakeMonitor` as follows.\n\n```ts\nimport { onSchedule } from 'firebase-functions/v2/scheduler'\nimport { schedulePublicOption } from '@/routings/options'\nimport {\n  RewardDataResponse,\n  getAllStakeRewardsByPubkey,\n  getCurrentEpoch,\n} from '@skeet-framework/solana-utils'\nimport { defineSecret } from 'firebase-functions/params'\nimport { format, sendDiscord } from '@skeet-framework/utils'\nimport { add, get, query, update } from '@skeet-framework/firestore'\nimport {\n  Wallet,\n  WalletCN,\n  WalletStakeReward,\n  genWalletStakeRewardPath,\n} from '@/models/walletModels'\nimport { db } from '@/index'\n\n// Define secrets\nconst DISCORD_WEBHOOK_URL = defineSecret('DISCORD_WEBHOOK_URL')\nconst HELIUS_ENDPOINT = defineSecret('HELIUS_ENDPOINT')\n\nexport const stakeMonitor = onSchedule(\n  { ...schedulePublicOption, secrets: [DISCORD_WEBHOOK_URL, HELIUS_ENDPOINT] },\n  async (event) =\u003e {\n    try {\n      // Get all wallets\n      const wallets = await query\u003cWallet\u003e(db, WalletCN, [\n        { field: 'pubkey', operator: '!=', value: '' },\n      ])\n\n      // If no wallet found, return\n      if (wallets.length === 0) {\n        console.log({ status: 'error', message: 'No wallet found' })\n        return\n      }\n\n      // Check if already checked\n      const lastEpoch = await getCurrentEpoch(HELIUS_ENDPOINT.value())\n      const lastReward = await get\u003cWalletStakeReward\u003e(\n        db,\n        genWalletStakeRewardPath(wallets[0].pubkey),\n        String(lastEpoch - 1)\n      )\n\n      // If already checked, return\n      if (lastReward) {\n        console.log({ status: 'ok', message: 'Already checked' })\n        return\n      }\n\n      // Get wallet\n      const wallet = await get\u003cWallet\u003e(db, WalletCN, wallets[0].pubkey)\n      if (!wallet) {\n        console.log({ status: 'error', message: 'Wallet not found' })\n        return\n      }\n\n      // Get all stake rewards\n      for await (const wallet of wallets) {\n        const walletPubkey = wallet.pubkey\n        const result: RewardDataResponse = await getAllStakeRewardsByPubkey(\n          HELIUS_ENDPOINT.value(),\n          walletPubkey\n        )\n        const walletStakeRewardParams: WalletStakeReward = {\n          date: format(new Date(), 'yyyy-MM-dd'),\n          epoch: result.epoch,\n          totalRewardAmount: result.totalRewardAmount,\n          totalBalance: result.totalBalance,\n        }\n\n        // Add walletStakeReward\n        await add\u003cWalletStakeReward\u003e(\n          db,\n          genWalletStakeRewardPath(walletPubkey),\n          walletStakeRewardParams,\n          String(result.epoch)\n        )\n\n        // Update wallet totalSol and totalRewardAmount\n        await update\u003cWallet\u003e(db, WalletCN, walletPubkey, {\n          totalSol: wallet.totalSol + result.totalBalance,\n          totalRewardAmount:\n            wallet.totalRewardAmount + result.totalRewardAmount,\n        })\n\n        // Generate content\n        const content = `Account: ${walletPubkey}\nEpoch: ${result.epoch}\nReward: ${result.totalRewardAmount} SOL\nTotal SOL: ${result.totalBalance} SOL\n`\n\n        // Send discord message\n        await sendDiscord(content, {\n          webhookUrl: DISCORD_WEBHOOK_URL.value(),\n          username: 'Skeet Staking Monitor',\n        })\n      }\n      console.log({ status: 'success' })\n    } catch (error) {\n      console.log({ status: 'error', message: String(error) })\n    }\n  }\n)\n```\n\n## üöÄ Deploy and Update the App\n\nDeploy to apply changes.\n\n```bash\nskeet deploy --function skeet:stakeMonitor\n```\n\n## ‚è≤Ô∏è Running the Scheduler\n\nSimilarly, when executed from the Scheduler:\n\n![](https://storage.googleapis.com/zenn-user-upload/8588406d71be-20231123.png)\n\n![](https://storage.googleapis.com/epics-bucket/solv2/solv-firestore-epoch.png)\n\n![](https://storage.googleapis.com/zenn-user-upload/24fe5c9f6e22-20231123.png)\n\nThe data has been successfully saved to Firestore, and a notification has been received üéâ\n\nLet's run the Scheduler again.\nSince the data is already saved in Firestore, the same notification will not be received again.\n\nNow, by registering the addresses of the wallets you want to manage in the same way,\nyou can start managing the staking rewards of multiple wallets üéâ\n\n## üìä Creating a Spreadsheet\n\nNext, let's set up synchronization of data to a `Google Spreadsheet` when new data is added.\n\nFirst, create a Google Spreadsheet using the link below, and take note of the following:\n\nSpreadsheet ID - `spreadsheetId`\nSheet Name - `sheetTitle` (here we use StakeRewards)\n\nCopy and paste the following values into the header:\n\n```bash\nDate\tAddress\tRewardAmount(SOL)\tEpoch\tPostBalance(SOL)\n```\n\nhttps://docs.google.com/spreadsheets\n\n![](https://storage.googleapis.com/zenn-user-upload/845a9fad4bae-20231123.png)\n\nThen, add your service account by clicking `Share` in the top right corner.\n\nReplace `appName` and `project-id` with the ones you have set up:\n\n```bash\n\u003cappName\u003e@\u003cproject-id\u003e.iam.gserviceaccount.com\n```\n\n`appName` should match the value of app:name in `./skeet-cloud.config.json`.\n\n## üîÑ Adding Synchronization with Spreadsheets\n\nWhile you can add features to the previously created `stakeMonitor`, managing many addresses can become cumbersome due to heavy processing. Therefore, we will add the functionality by separating it into `Cloud Functions for Firebase` with a `Firestore` trigger.\n\nFirst, add the `@skeet-framework/spreadsheet-utils` package.\n\n```bash\nskeet yarn add -p @skeet-framework/spreadsheet-utils\n```\n\nUse the `skeet add method` command to add a `firestore` instance template.\n\n```bash\nskeet add method addSpreadsheet\n? Select Instance Type to add firestore\n‚úî ./functions/skeet/src/routings/firestore/addSpreadsheet.ts created üéâ\n‚úî Successfully exported to ./functions/skeet/src/index.ts üéâ\n```\n\nThen, edit `addSpreadsheet.ts` as follows.\n\n```ts\nimport { onDocumentCreated } from 'firebase-functions/v2/firestore'\nimport { firestoreDefaultOption } from '@/routings/options'\nimport { addDataToSheet } from '@skeet-framework/spreadsheet-utils'\nimport { sendDiscord } from '@skeet-framework/utils'\nimport { defineSecret } from 'firebase-functions/params'\n\nconst DISCORD_WEBHOOK_URL = defineSecret('DISCORD_WEBHOOK_URL')\n\nexport const addSpreadsheet = onDocumentCreated(\n  {\n    ...firestoreDefaultOption('Wallet/{pubkey}/WalletStakeReward/{epoch}'),\n    secrets: [DISCORD_WEBHOOK_URL],\n  },\n  async (event) =\u003e {\n    console.log(`addSpreadsheet triggered!`)\n    try {\n      // Define spreadsheet params\n      const spreadsheetId = '1mLN3pUee-thUfys-UfpeHvnjVmZZX_KLWxp76-49COY'\n      const sheetTitle = 'StakeRewards'\n      const walletPubkey = event.params.pubkey\n      const epoch = event.data?.get('epoch') as number\n      const totalRewardAmount = event.data?.get('totalRewardAmount') as number\n      const totalBalance = event.data?.get('totalBalance') as number\n\n      // Add data to spreadsheet\n      await addDataToSheet(spreadsheetId, sheetTitle, [\n        [\n          event.data?.get('date'),\n          walletPubkey,\n          totalRewardAmount,\n          epoch,\n          totalBalance,\n        ],\n      ])\n\n      // Generate Message Content\n      const content = `Account: ${walletPubkey}\nEpoch: ${epoch}\nReward: ${totalRewardAmount} SOL\nTotal SOL: ${totalBalance} SOL`\n\n      // Send discord message\n      await sendDiscord(content, {\n        webhookUrl: DISCORD_WEBHOOK_URL.value(),\n        username: 'Skeet Staking Monitor',\n      })\n      console.log({ status: 'success' })\n    } catch (error) {\n      console.log({ status: 'error', message: String(error) })\n    }\n  }\n)\n```\n\nMove the Discord notification from `stakeMonitor` to `addSpreadsheet`, and change it to notify when new data is added to the Google Spreadsheet.\n\n## üõ†Ô∏è Updating stakeMonitor\n\nTherefore, remove the Discord notification part from `stakeMonitor.ts` as follows.\n\n```ts\nimport { onSchedule } from 'firebase-functions/v2/scheduler'\nimport { schedulePublicOption } from '@/routings/options'\nimport {\n  RewardDataResponse,\n  getAllStakeRewardsByPubkey,\n  getCurrentEpoch,\n} from '@skeet-framework/solana-utils'\nimport { defineSecret } from 'firebase-functions/params'\nimport { format } from '@skeet-framework/utils'\nimport { add, get, query, update } from '@skeet-framework/firestore'\nimport {\n  Wallet,\n  WalletCN,\n  WalletStakeReward,\n  genWalletStakeRewardPath,\n} from '@/models/walletModels'\nimport { db } from '@/index'\n\n// Define secrets\nconst HELIUS_ENDPOINT = defineSecret('HELIUS_ENDPOINT')\n\nexport const stakeMonitor = onSchedule(\n  { ...schedulePublicOption, secrets: [HELIUS_ENDPOINT] },\n  async (event) =\u003e {\n    try {\n      // Get all wallets\n      const wallets = await query\u003cWallet\u003e(db, WalletCN, [\n        { field: 'pubkey', operator: '!=', value: '' },\n      ])\n\n      // If no wallet found, return\n      if (wallets.length === 0) {\n        console.log({ status: 'error', message: 'No wallet found' })\n        return\n      }\n\n      // Check if already checked\n      const lastEpoch = await getCurrentEpoch(HELIUS_ENDPOINT.value())\n      const lastReward = await get\u003cWalletStakeReward\u003e(\n        db,\n        genWalletStakeRewardPath(wallets[0].pubkey),\n        String(lastEpoch - 1)\n      )\n\n      // If already checked, return\n      if (lastReward) {\n        console.log({ status: 'ok', message: 'Already checked' })\n        return\n      }\n\n      // Get wallet\n      const wallet = await get\u003cWallet\u003e(db, WalletCN, wallets[0].pubkey)\n      if (!wallet) {\n        console.log({ status: 'error', message: 'Wallet not found' })\n        return\n      }\n\n      // Get all stake rewards\n      for await (const wallet of wallets) {\n        const walletPubkey = wallet.pubkey\n        const result: RewardDataResponse = await getAllStakeRewardsByPubkey(\n          HELIUS_ENDPOINT.value(),\n          walletPubkey\n        )\n        const walletStakeRewardParams: WalletStakeReward = {\n          date: format(new Date(), 'yyyy-MM-dd'),\n          epoch: result.epoch,\n          totalRewardAmount: result.totalRewardAmount,\n          totalBalance: result.totalBalance,\n        }\n\n        // Add walletStakeReward\n        await add\u003cWalletStakeReward\u003e(\n          db,\n          genWalletStakeRewardPath(walletPubkey),\n          walletStakeRewardParams,\n          String(result.epoch)\n        )\n\n        // Update wallet totalSol and totalRewardAmount\n        await update\u003cWallet\u003e(db, WalletCN, walletPubkey, {\n          totalSol: wallet.totalSol + result.totalBalance,\n          totalRewardAmount:\n            wallet.totalRewardAmount + result.totalRewardAmount,\n        })\n      }\n      console.log({ status: 'success' })\n    } catch (error) {\n      console.log({ status: 'error', message: String(error) })\n    }\n  }\n)\n```\n\n## üöÄ Deploy and Update the App\n\nLet's deploy again to update the app.\n\n```bash\nskeet deploy\n? Select Functions to deploy (Press \u003cspace\u003e to select, \u003ca\u003e to toggle all, \u003ci\u003e to invert selection, and \u003center\u003e\nto proceed)\n  = Functions =\n ‚óØ solvMonitor\n ‚óâ stakeMonitor\n‚ùØ‚óâ addSpreadsheet\n```\n\n## ‚è≤Ô∏è Running the Scheduler\n\nOnce again, delete the records from Firestore's `WalletStakeReward`,\n\nand run the Scheduler.\n\nThe spreadsheet has been successfully updated, and\na notification has been sent to Discord üéâ\n\n![](https://storage.googleapis.com/zenn-user-upload/2bd77535a879-20231123.png)\n\nNow, notifications will only be sent during regular checks if there is new data, allowing for synchronization with the spreadsheet.\n\n## üåê Combining Load Balancer with Google Cloud Armor\n\nEnhancing Webhook Endpoints\n\nFirebase Functions are a powerful tool for quickly and efficiently building webhook endpoints, but as your project grows, there comes a need to bolster its infrastructure. This is where the introduction of a load balancer becomes key. By using a load balancer, you can significantly improve the performance and reliability of your endpoints, making them resilient to high traffic and unusual access patterns.\n\nFurthermore, integrating Google Cloud Armor greatly enhances security. Google Cloud Armor is a robust tool designed to protect against DDoS and web attacks, and when used in conjunction with a load balancer, it provides a strong defensive layer to safeguard your webhook endpoints from various threats. This ensures more stable service delivery to end-users and increases the trustworthiness of your business.\n\nWhile a simple setup may suffice in the early stages, as your project grows, considering the implementation of a load balancer and Google Cloud Armor can greatly strengthen network stability and security. This strategic approach allows you to swiftly meet the evolving needs as your business scales up, ensuring consistent delivery of high-quality services to end-users.\n\nFor instructions on how to configure a load balancer and Google Cloud Armor, please refer to the following link:\n\nhttps://skeet.dev/en/doc/skeet-firestore/initial-deploy/\n"},"articleHtml":"\u003cp\u003eIn this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets. We cover the entire process from data collection to analysis and reporting, aiming for real-time performance tracking and faster decision-making. By combining Firestore‚Äôs powerful database capabilities with the accessibility of Google Spreadsheets, we achieve automation and optimization in revenue management. Through this chapter, you can gain not only technical knowledge but also effective data utilization methods.\u003c/p\u003e\n\u003ch2 id=\"-creating-firestore-models\" class=\"font-extrabold tracking-tighter break-word\"\u003eüìù Creating Firestore Models\u003c/h2\u003e\n\u003cp\u003eAs it stands from the previous chapter, the scheduler will notify about duplicate data every time it checks. We will improve this by recording data in \u003ccode\u003eFirestore\u003c/code\u003e and only notifying when new data is added.\u003c/p\u003e\n\u003cp\u003eWe will create two models called \u003ccode\u003eWallet\u003c/code\u003e and \u003ccode\u003eWalletStakeReward\u003c/code\u003e as follows.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efunctions/skeet/src/models/walletModels.ts\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eTimestamp\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eFieldValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/firestore'\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// CollectionId: WalletPubkey\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// DocumentId: walletPubkey - e.g. LKnGHsjr7UYBXnzfbrz4k6QotCz56rMQTSiVwdRSyL9\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Path: WalletPubkey\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWalletPubkeyCN\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'WalletPubkey'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egenWalletPubkeyPath\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) =\u003e \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${WalletPubkeyCN}\u003c/span\u003e`\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWalletPubkey\u003c/span\u003e = {\n  id?: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ewalletPubkey\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etotalSol\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n  createdAt?: \u003cspan class=\"hljs-title class_\"\u003eTimestamp\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eFieldValue\u003c/span\u003e\n  updatedAt?: \u003cspan class=\"hljs-title class_\"\u003eTimestamp\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eFieldValue\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// CollectionId: StakeReward\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// DocumentId: epoch - e.g. 420\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Path: StakeReward\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStakeRewardCN\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'StakeReward'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egenStakeRewardPath\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003epubkey: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e\n  \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${WalletPubkeyCN}\u003c/span\u003e/\u003cspan class=\"hljs-subst\"\u003e${pubkey}\u003c/span\u003e/\u003cspan class=\"hljs-subst\"\u003e${StakeRewardCN}\u003c/span\u003e`\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStakeReward\u003c/span\u003e = {\n  id?: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ewalletPubkey\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eepoch\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etotalBalance\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n  createdAt?: \u003cspan class=\"hljs-title class_\"\u003eTimestamp\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eFieldValue\u003c/span\u003e\n  updatedAt?: \u003cspan class=\"hljs-title class_\"\u003eTimestamp\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eFieldValue\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"-registering-managed-addresses\" class=\"font-extrabold tracking-tighter break-word\"\u003eüìå Registering Managed Addresses\u003c/h2\u003e\n\u003cp\u003eTDS rewards are issued monthly to the \u003ccode\u003eauthority\u003c/code\u003e account by staking accounts, but here we will use \u003ccode\u003e@skeet-framework/solana-utils\u003c/code\u003e to register the address of the \u003ccode\u003eauthority\u003c/code\u003e account. By doing so, you can collectively check the rewards for the associated stake accounts.\u003c/p\u003e\n\u003cp\u003eCreate a script in the following directory to register the pubkey of the managed wallet in Firestore. You can also enter data directly from the Firebase browser, so please add the data by any preferred method.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efunctions/skeet/src/script/addWallet.ts\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/models/walletModels'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { add } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/firestore'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { format } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e admin \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-admin'\u003c/span\u003e\nadmin.\u003cspan class=\"hljs-title function_\"\u003einitializeApp\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e db = admin.\u003cspan class=\"hljs-title function_\"\u003efirestore\u003c/span\u003e()\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eaddWallet\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003epubkey: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ewalletParams\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e = {\n    \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-title function_\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e(), \u003cspan class=\"hljs-string\"\u003e'yyyy-MM-dd'\u003c/span\u003e),\n    pubkey,\n    \u003cspan class=\"hljs-attr\"\u003etotalSol\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\n  }\n  \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e add\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, walletParams, pubkey)\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'success'\u003c/span\u003e })\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003erun\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) =\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e pubkey = \u003cspan class=\"hljs-string\"\u003e'your-authority-keypair'\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eaddWallet\u003c/span\u003e(pubkey)\n}\n\n\u003cspan class=\"hljs-title function_\"\u003erun\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMove to the \u003ccode\u003efunctions/skeet\u003c/code\u003e directory and execute the script.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003efunctions\u003c/span\u003e/skeet \u0026#x26;\u0026#x26; npx ts-node -r tsconfig-paths/register --transpile-only src/scripts/addWallet.ts\n{ status: \u003cspan class=\"hljs-string\"\u003e'success'\u003c/span\u003e }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUpon checking Firebase's Firestore, the data has been successfully created üéâ\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/epics-bucket/solv2/solv-wallet.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-updating-stakemonitor\" class=\"font-extrabold tracking-tighter break-word\"\u003eüîÑ Updating StakeMonitor\u003c/h2\u003e\n\u003cp\u003eLet's update \u003ccode\u003eStakeMonitor\u003c/code\u003e as follows.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { onSchedule } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/v2/scheduler'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { schedulePublicOption } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/routings/options'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {\n  \u003cspan class=\"hljs-title class_\"\u003eRewardDataResponse\u003c/span\u003e,\n  getAllStakeRewardsByPubkey,\n  getCurrentEpoch,\n} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/solana-utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { defineSecret } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/params'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { format, sendDiscord } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { add, get, query, update } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/firestore'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {\n  \u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e,\n  \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e,\n  \u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e,\n  genWalletStakeRewardPath,\n} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/models/walletModels'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { db } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/index'\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Define secrets\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineSecret\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'DISCORD_WEBHOOK_URL'\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineSecret\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'HELIUS_ENDPOINT'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e stakeMonitor = \u003cspan class=\"hljs-title function_\"\u003eonSchedule\u003c/span\u003e(\n  { ...schedulePublicOption, \u003cspan class=\"hljs-attr\"\u003esecrets\u003c/span\u003e: [\u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e] },\n  \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (event) =\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Get all wallets\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallets = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e query\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, [\n        { \u003cspan class=\"hljs-attr\"\u003efield\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'pubkey'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eoperator\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'!='\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e },\n      ])\n\n      \u003cspan class=\"hljs-comment\"\u003e// If no wallet found, return\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (wallets.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e === \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'No wallet found'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Check if already checked\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e lastEpoch = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetCurrentEpoch\u003c/span\u003e(\u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e())\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e lastReward = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e get\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e\u003e(\n        db,\n        \u003cspan class=\"hljs-title function_\"\u003egenWalletStakeRewardPath\u003c/span\u003e(wallets[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e),\n        \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(lastEpoch - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n      )\n\n      \u003cspan class=\"hljs-comment\"\u003e// If already checked, return\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (lastReward) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'ok'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Already checked'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get wallet\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallet = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e get\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, wallets[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e)\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!wallet) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Wallet not found'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get all stake rewards\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallet \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e wallets) {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e walletPubkey = wallet.\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eresult\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eRewardDataResponse\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetAllStakeRewardsByPubkey\u003c/span\u003e(\n          \u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e(),\n          walletPubkey\n        )\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ewalletStakeRewardParams\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e = {\n          \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-title function_\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e(), \u003cspan class=\"hljs-string\"\u003e'yyyy-MM-dd'\u003c/span\u003e),\n          \u003cspan class=\"hljs-attr\"\u003eepoch\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003eepoch\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalBalance\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003etotalBalance\u003c/span\u003e,\n        }\n\n        \u003cspan class=\"hljs-comment\"\u003e// Add walletStakeReward\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e add\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e\u003e(\n          db,\n          \u003cspan class=\"hljs-title function_\"\u003egenWalletStakeRewardPath\u003c/span\u003e(walletPubkey),\n          walletStakeRewardParams,\n          \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(result.\u003cspan class=\"hljs-property\"\u003eepoch\u003c/span\u003e)\n        )\n\n        \u003cspan class=\"hljs-comment\"\u003e// Update wallet totalSol and totalRewardAmount\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e update\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, walletPubkey, {\n          \u003cspan class=\"hljs-attr\"\u003etotalSol\u003c/span\u003e: wallet.\u003cspan class=\"hljs-property\"\u003etotalSol\u003c/span\u003e + result.\u003cspan class=\"hljs-property\"\u003etotalBalance\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e:\n            wallet.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e + result.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e,\n        })\n\n        \u003cspan class=\"hljs-comment\"\u003e// Generate content\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e content = \u003cspan class=\"hljs-string\"\u003e`Account: \u003cspan class=\"hljs-subst\"\u003e${walletPubkey}\u003c/span\u003e\nEpoch: \u003cspan class=\"hljs-subst\"\u003e${result.epoch}\u003c/span\u003e\nReward: \u003cspan class=\"hljs-subst\"\u003e${result.totalRewardAmount}\u003c/span\u003e SOL\nTotal SOL: \u003cspan class=\"hljs-subst\"\u003e${result.totalBalance}\u003c/span\u003e SOL\n`\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e// Send discord message\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esendDiscord\u003c/span\u003e(content, {\n          \u003cspan class=\"hljs-attr\"\u003ewebhookUrl\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e(),\n          \u003cspan class=\"hljs-attr\"\u003eusername\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Skeet Staking Monitor'\u003c/span\u003e,\n        })\n      }\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'success'\u003c/span\u003e })\n    } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(error) })\n    }\n  }\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"-deploy-and-update-the-app\" class=\"font-extrabold tracking-tighter break-word\"\u003eüöÄ Deploy and Update the App\u003c/h2\u003e\n\u003cp\u003eDeploy to apply changes.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eskeet deploy --\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e skeet:stakeMonitor\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"Ô∏è-running-the-scheduler\" class=\"font-extrabold tracking-tighter break-word\"\u003e‚è≤Ô∏è Running the Scheduler\u003c/h2\u003e\n\u003cp\u003eSimilarly, when executed from the Scheduler:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/zenn-user-upload/8588406d71be-20231123.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/epics-bucket/solv2/solv-firestore-epoch.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/zenn-user-upload/24fe5c9f6e22-20231123.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThe data has been successfully saved to Firestore, and a notification has been received üéâ\u003c/p\u003e\n\u003cp\u003eLet's run the Scheduler again.\nSince the data is already saved in Firestore, the same notification will not be received again.\u003c/p\u003e\n\u003cp\u003eNow, by registering the addresses of the wallets you want to manage in the same way,\nyou can start managing the staking rewards of multiple wallets üéâ\u003c/p\u003e\n\u003ch2 id=\"-creating-a-spreadsheet\" class=\"font-extrabold tracking-tighter break-word\"\u003eüìä Creating a Spreadsheet\u003c/h2\u003e\n\u003cp\u003eNext, let's set up synchronization of data to a \u003ccode\u003eGoogle Spreadsheet\u003c/code\u003e when new data is added.\u003c/p\u003e\n\u003cp\u003eFirst, create a Google Spreadsheet using the link below, and take note of the following:\u003c/p\u003e\n\u003cp\u003eSpreadsheet ID - \u003ccode\u003espreadsheetId\u003c/code\u003e\nSheet Name - \u003ccode\u003esheetTitle\u003c/code\u003e (here we use StakeRewards)\u003c/p\u003e\n\u003cp\u003eCopy and paste the following values into the header:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eDate\tAddress\tRewardAmount(SOL)\tEpoch\tPostBalance(SOL)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://docs.google.com/spreadsheets\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://docs.google.com/spreadsheets\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/zenn-user-upload/845a9fad4bae-20231123.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThen, add your service account by clicking \u003ccode\u003eShare\u003c/code\u003e in the top right corner.\u003c/p\u003e\n\u003cp\u003eReplace \u003ccode\u003eappName\u003c/code\u003e and \u003ccode\u003eproject-id\u003c/code\u003e with the ones you have set up:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u0026#x3C;appName\u003e@\u0026#x3C;project-id\u003e.iam.gserviceaccount.com\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eappName\u003c/code\u003e should match the value of app\u003cdiv\u003e\u003c/div\u003e in \u003ccode\u003e./skeet-cloud.config.json\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"-adding-synchronization-with-spreadsheets\" class=\"font-extrabold tracking-tighter break-word\"\u003eüîÑ Adding Synchronization with Spreadsheets\u003c/h2\u003e\n\u003cp\u003eWhile you can add features to the previously created \u003ccode\u003estakeMonitor\u003c/code\u003e, managing many addresses can become cumbersome due to heavy processing. Therefore, we will add the functionality by separating it into \u003ccode\u003eCloud Functions for Firebase\u003c/code\u003e with a \u003ccode\u003eFirestore\u003c/code\u003e trigger.\u003c/p\u003e\n\u003cp\u003eFirst, add the \u003ccode\u003e@skeet-framework/spreadsheet-utils\u003c/code\u003e package.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eskeet yarn add -p @skeet-framework/spreadsheet-utils\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUse the \u003ccode\u003eskeet add method\u003c/code\u003e command to add a \u003ccode\u003efirestore\u003c/code\u003e instance template.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eskeet add method addSpreadsheet\n? Select Instance Type to add firestore\n‚úî ./functions/skeet/src/routings/firestore/addSpreadsheet.ts created üéâ\n‚úî Successfully exported to ./functions/skeet/src/index.ts üéâ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, edit \u003ccode\u003eaddSpreadsheet.ts\u003c/code\u003e as follows.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { onDocumentCreated } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/v2/firestore'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { firestoreDefaultOption } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/routings/options'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { addDataToSheet } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/spreadsheet-utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { sendDiscord } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { defineSecret } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/params'\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineSecret\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'DISCORD_WEBHOOK_URL'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e addSpreadsheet = \u003cspan class=\"hljs-title function_\"\u003eonDocumentCreated\u003c/span\u003e(\n  {\n    ...\u003cspan class=\"hljs-title function_\"\u003efirestoreDefaultOption\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Wallet/{pubkey}/WalletStakeReward/{epoch}'\u003c/span\u003e),\n    \u003cspan class=\"hljs-attr\"\u003esecrets\u003c/span\u003e: [\u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e],\n  },\n  \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (event) =\u003e {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`addSpreadsheet triggered!`\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Define spreadsheet params\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e spreadsheetId = \u003cspan class=\"hljs-string\"\u003e'1mLN3pUee-thUfys-UfpeHvnjVmZZX_KLWxp76-49COY'\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e sheetTitle = \u003cspan class=\"hljs-string\"\u003e'StakeRewards'\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e walletPubkey = event.\u003cspan class=\"hljs-property\"\u003eparams\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e epoch = event.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e?.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'epoch'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e totalRewardAmount = event.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e?.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'totalRewardAmount'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e totalBalance = event.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e?.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'totalBalance'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\n\n      \u003cspan class=\"hljs-comment\"\u003e// Add data to spreadsheet\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eaddDataToSheet\u003c/span\u003e(spreadsheetId, sheetTitle, [\n        [\n          event.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e?.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'date'\u003c/span\u003e),\n          walletPubkey,\n          totalRewardAmount,\n          epoch,\n          totalBalance,\n        ],\n      ])\n\n      \u003cspan class=\"hljs-comment\"\u003e// Generate Message Content\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e content = \u003cspan class=\"hljs-string\"\u003e`Account: \u003cspan class=\"hljs-subst\"\u003e${walletPubkey}\u003c/span\u003e\nEpoch: \u003cspan class=\"hljs-subst\"\u003e${epoch}\u003c/span\u003e\nReward: \u003cspan class=\"hljs-subst\"\u003e${totalRewardAmount}\u003c/span\u003e SOL\nTotal SOL: \u003cspan class=\"hljs-subst\"\u003e${totalBalance}\u003c/span\u003e SOL`\u003c/span\u003e\n\n      \u003cspan class=\"hljs-comment\"\u003e// Send discord message\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esendDiscord\u003c/span\u003e(content, {\n        \u003cspan class=\"hljs-attr\"\u003ewebhookUrl\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eDISCORD_WEBHOOK_URL\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e(),\n        \u003cspan class=\"hljs-attr\"\u003eusername\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Skeet Staking Monitor'\u003c/span\u003e,\n      })\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'success'\u003c/span\u003e })\n    } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(error) })\n    }\n  }\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMove the Discord notification from \u003ccode\u003estakeMonitor\u003c/code\u003e to \u003ccode\u003eaddSpreadsheet\u003c/code\u003e, and change it to notify when new data is added to the Google Spreadsheet.\u003c/p\u003e\n\u003ch2 id=\"Ô∏è-updating-stakemonitor\" class=\"font-extrabold tracking-tighter break-word\"\u003eüõ†Ô∏è Updating stakeMonitor\u003c/h2\u003e\n\u003cp\u003eTherefore, remove the Discord notification part from \u003ccode\u003estakeMonitor.ts\u003c/code\u003e as follows.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { onSchedule } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/v2/scheduler'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { schedulePublicOption } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/routings/options'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {\n  \u003cspan class=\"hljs-title class_\"\u003eRewardDataResponse\u003c/span\u003e,\n  getAllStakeRewardsByPubkey,\n  getCurrentEpoch,\n} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/solana-utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { defineSecret } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'firebase-functions/params'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { format } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/utils'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { add, get, query, update } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@skeet-framework/firestore'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {\n  \u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e,\n  \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e,\n  \u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e,\n  genWalletStakeRewardPath,\n} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/models/walletModels'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { db } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@/index'\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Define secrets\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineSecret\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'HELIUS_ENDPOINT'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e stakeMonitor = \u003cspan class=\"hljs-title function_\"\u003eonSchedule\u003c/span\u003e(\n  { ...schedulePublicOption, \u003cspan class=\"hljs-attr\"\u003esecrets\u003c/span\u003e: [\u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e] },\n  \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (event) =\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Get all wallets\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallets = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e query\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, [\n        { \u003cspan class=\"hljs-attr\"\u003efield\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'pubkey'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eoperator\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'!='\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e },\n      ])\n\n      \u003cspan class=\"hljs-comment\"\u003e// If no wallet found, return\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (wallets.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e === \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'No wallet found'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Check if already checked\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e lastEpoch = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetCurrentEpoch\u003c/span\u003e(\u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e())\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e lastReward = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e get\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e\u003e(\n        db,\n        \u003cspan class=\"hljs-title function_\"\u003egenWalletStakeRewardPath\u003c/span\u003e(wallets[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e),\n        \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(lastEpoch - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n      )\n\n      \u003cspan class=\"hljs-comment\"\u003e// If already checked, return\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (lastReward) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'ok'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Already checked'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get wallet\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallet = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e get\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, wallets[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e)\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!wallet) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Wallet not found'\u003c/span\u003e })\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n      }\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get all stake rewards\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e wallet \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e wallets) {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e walletPubkey = wallet.\u003cspan class=\"hljs-property\"\u003epubkey\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eresult\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eRewardDataResponse\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetAllStakeRewardsByPubkey\u003c/span\u003e(\n          \u003cspan class=\"hljs-variable constant_\"\u003eHELIUS_ENDPOINT\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003evalue\u003c/span\u003e(),\n          walletPubkey\n        )\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ewalletStakeRewardParams\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e = {\n          \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-title function_\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e(), \u003cspan class=\"hljs-string\"\u003e'yyyy-MM-dd'\u003c/span\u003e),\n          \u003cspan class=\"hljs-attr\"\u003eepoch\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003eepoch\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalBalance\u003c/span\u003e: result.\u003cspan class=\"hljs-property\"\u003etotalBalance\u003c/span\u003e,\n        }\n\n        \u003cspan class=\"hljs-comment\"\u003e// Add walletStakeReward\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e add\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWalletStakeReward\u003c/span\u003e\u003e(\n          db,\n          \u003cspan class=\"hljs-title function_\"\u003egenWalletStakeRewardPath\u003c/span\u003e(walletPubkey),\n          walletStakeRewardParams,\n          \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(result.\u003cspan class=\"hljs-property\"\u003eepoch\u003c/span\u003e)\n        )\n\n        \u003cspan class=\"hljs-comment\"\u003e// Update wallet totalSol and totalRewardAmount\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e update\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eWallet\u003c/span\u003e\u003e(db, \u003cspan class=\"hljs-title class_\"\u003eWalletCN\u003c/span\u003e, walletPubkey, {\n          \u003cspan class=\"hljs-attr\"\u003etotalSol\u003c/span\u003e: wallet.\u003cspan class=\"hljs-property\"\u003etotalSol\u003c/span\u003e + result.\u003cspan class=\"hljs-property\"\u003etotalBalance\u003c/span\u003e,\n          \u003cspan class=\"hljs-attr\"\u003etotalRewardAmount\u003c/span\u003e:\n            wallet.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e + result.\u003cspan class=\"hljs-property\"\u003etotalRewardAmount\u003c/span\u003e,\n        })\n      }\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'success'\u003c/span\u003e })\n    } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'error'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e(error) })\n    }\n  }\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"-deploy-and-update-the-app-1\" class=\"font-extrabold tracking-tighter break-word\"\u003eüöÄ Deploy and Update the App\u003c/h2\u003e\n\u003cp\u003eLet's deploy again to update the app.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eskeet deploy\n? Select Functions to deploy (Press \u0026#x3C;space\u003e to \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e, \u0026#x3C;a\u003e to toggle all, \u0026#x3C;i\u003e to invert selection, and \u0026#x3C;enter\u003e\nto proceed)\n  = Functions =\n ‚óØ solvMonitor\n ‚óâ stakeMonitor\n‚ùØ‚óâ addSpreadsheet\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"Ô∏è-running-the-scheduler-1\" class=\"font-extrabold tracking-tighter break-word\"\u003e‚è≤Ô∏è Running the Scheduler\u003c/h2\u003e\n\u003cp\u003eOnce again, delete the records from Firestore's \u003ccode\u003eWalletStakeReward\u003c/code\u003e,\u003c/p\u003e\n\u003cp\u003eand run the Scheduler.\u003c/p\u003e\n\u003cp\u003eThe spreadsheet has been successfully updated, and\na notification has been sent to Discord üéâ\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://storage.googleapis.com/zenn-user-upload/2bd77535a879-20231123.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eNow, notifications will only be sent during regular checks if there is new data, allowing for synchronization with the spreadsheet.\u003c/p\u003e\n\u003ch2 id=\"-combining-load-balancer-with-google-cloud-armor\" class=\"font-extrabold tracking-tighter break-word\"\u003eüåê Combining Load Balancer with Google Cloud Armor\u003c/h2\u003e\n\u003cp\u003eEnhancing Webhook Endpoints\u003c/p\u003e\n\u003cp\u003eFirebase Functions are a powerful tool for quickly and efficiently building webhook endpoints, but as your project grows, there comes a need to bolster its infrastructure. This is where the introduction of a load balancer becomes key. By using a load balancer, you can significantly improve the performance and reliability of your endpoints, making them resilient to high traffic and unusual access patterns.\u003c/p\u003e\n\u003cp\u003eFurthermore, integrating Google Cloud Armor greatly enhances security. Google Cloud Armor is a robust tool designed to protect against DDoS and web attacks, and when used in conjunction with a load balancer, it provides a strong defensive layer to safeguard your webhook endpoints from various threats. This ensures more stable service delivery to end-users and increases the trustworthiness of your business.\u003c/p\u003e\n\u003cp\u003eWhile a simple setup may suffice in the early stages, as your project grows, considering the implementation of a load balancer and Google Cloud Armor can greatly strengthen network stability and security. This strategic approach allows you to swiftly meet the evolving needs as your business scales up, ensuring consistent delivery of high-quality services to end-users.\u003c/p\u003e\n\u003cp\u003eFor instructions on how to configure a load balancer and Google Cloud Armor, please refer to the following link:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://skeet.dev/en/doc/skeet-firestore/initial-deploy/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://skeet.dev/en/doc/skeet-firestore/initial-deploy/\u003c/a\u003e\u003c/p\u003e","title":"Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes","seoData":[{"property":"og:title","content":"Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"},{"name":"twitter:title","content":"Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"},{"name":"twitter:text:title","content":"Chapter 4: üìäüî• Utilizing Firestore and Google Spreadsheets for Revenue Management ‚Äî A Guide to Efficient Data Tracking and Analysis üìà | solv - An Open-Source Tool for Easily Setting Up and Effortlessly Managing Solana Validators and RPC Nodes"},{"name":"description","content":"In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."},{"property":"og:description","content":"In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."},{"name":"twitter:description","content":"In this chapter, we will explain how to efficiently manage earnings as a Solana validator using Firebase‚Äôs Firestore and Google Spreadsheets."},{"property":"og:url","content":"https://solv.epics.dev/en/doc/tutorial/chapter4"},{"property":"og:image","content":"https://solv.epics.dev/ogp.png"},{"property":"og:image:secure","content":"https://solv.epics.dev/ogp.png"},{"name":"twitter:image","content":"https://solv.epics.dev/ogp.png"}],"_nextI18Next":{"initialI18nStore":{"en":{"common":{"contactToTeam":"Talk with Team","privacy":"Privacy","404title":"Page not found","404body":"Sorry, we couldn't find the page you're looking for.","backToTop":"Back to top page","toc":"Table of Contents","openMenu":"Open menu","closeMenu":"Close menu","media":"Media","news":"News","books":"Books","copy":"Copy","copied":"Copied!","solvInstall":"Install solv","updateSettings":"Update settings","setupSolv":"Setup","thatsAll":"That's all!","navs":{"defaultMainNav":{"quickstart":"Quickstart","news":"News","doc":"Docs","dao":"DAO","enterprise":"Enterprise","contact":"Contact"},"commonFooterNav":{"quickstart":"Quickstart","news":"News","doc":"Docs","enterprise":"Enterprise","dao":"DAO","contact":"Contact","privacy":"Privacy","press-kits":"Press Kits"}},"AgreeToPolicy":{"title":"Your Choices Regarding Cookies","body":"We and our third party partners use cookies and similar technologies to process certain information, such as your IP address and digital identifiers, to analyze site usage and provide you better experiences. Please read our privacy policy for the detail.","yes":"Yes, I Accept","no":"No, I Do Not Accept"},"ContactRow":{"discord":{"title":"Community Discord","body":"If you have any inquiries, please create a support ticket in the community Discord.","button":"JOIN"},"form":{"title":"Talk with Team","body":"If you have any inquiries about development and support, please get in touch with us from here.","button":"Go"}},"CTASectionRow":{"title":"The utility tool for Solana Validators","body":"solv is an open-source tool designed to simplify the setup and operation of Solana validators and RPC nodes.","button":"Get Started","demo":"Try Demo"},"WhyOpenSourceDevelopmentRow":{"subtitle":"Why Open-Source Software?","title":"Sustainable technology development and benefits for society as a whole","description":"Open-source software (OSS) development drives technological progress in modern society and enables new value creation.","feature1":{"title":"Value as a public good","description":"Open-source software is free for anyone to use, improve, and redistribute. This makes OSS a public good for all mankind. People all over the world can enjoy its value without feeling financially constrained. As a result, innovation across society will be driven, and the equality and inclusiveness of the digital society will increase."},"feature2":{"title":"Global cooperation","description":"In the world of OSS, developers all over the world work together to improve software beyond the boundaries of regions and organizations. Each person's perspective and expertise can be incorporated into the project, enhancing its quality. OSS is truly a global gathering place of knowledge and experience that consistently produces high-quality software."},"feature3":{"title":"Preventing reinvention of the wheel","description":"OSS allows us to reuse code and prevents us from reinventing the wheel. As a result, developers can focus less on creating everything from scratch and more on solving specific problems and developing new features. This increases efficiency and enables faster higher-quality results."}},"RoadmapRow":{"2022.6":"Epics Lite Paper, TGE (Token Generate Event)","2022.7":"Epics GENESIS presale","2022.8":"Epics White Paper v1","2022.9":"Epics Alpha launch, Solana Summer Camp Hackathon 5th prize","2022.10":"Presale for IDO, WBSO (Advanced R\u0026D) certified by the Dutch government","2022.11":"Solana Breakpoint, GitHub issue Data Oracle Collaborative Development (DIA)","2023.1":"IDO $EPCT on Orca (Solana DEX)","2023.4":"Epics DAO became a Solana Testnet Validator","2023.9":"Seed Extension Round Fundraising","2023.12":"Epics Platform Beta Launch","2024.2":"$EPCT Listed on Meteora (Solana DEX)","2024.4":"NFT Card Design Reveal, NICONICO CHOKAIGI 2024, ENASE 2024","2024.5":"Epics DAO became a Solana mainnet validator","2024.8":"NFT Card Game Œ≤ Test Begins, WebX 2024","2024.10":"Series A fundraising, EPCD Exchange Launch","2025.4":"Major Release of Epics Platform, General Release of the NFT Card Game","2025.9":"Series B Fundraising","2026.4":"IEO $EPCT"},"OurWorksRow":{"WBSO":{"title":"WBSO accreditation from the Dutch government","description":"Epics DAO has received WBSO (Advanced Science and Technology Research) accreditation from the Dutch government. Epics is a social contribution blockchain game (BCG) that aims to realize a sustainable open-source development environment."},"SolanaValidator":{"title":"We operate a validator for the Solana blockchain","description":"As a validator on the Solana chain, Epics DAO is committed to ensuring the reliability and stability of the network. We will also contribute to the technical aspects of achieving Solana's fast and stable network."},"SolanaSummerCamp":{"title":"Placed 5th at Solana Summer Camp Hackathon 2022","description":"Epics DAO won 5th place out of over 18,000 entries at the Solana Summer Camp Hackathon held July 11-August 16, 2022."},"GoogleWeb3":{"title":"ELSOUL LABO has been certified by Google Web3 Startups program","description":"ELSOUL LABO's activities in the Web3 sector, including Epics DAO, and support for open-source development initiatives such as solv and Skeet, have been recognized and selected for the Google Cloud Web3 Startups program."},"ENASE2024":{"title":"Research Paper on AI \u0026 Serverless 'Skeet' Accepted for ENASE 2024","description":"The research paper 'Skeet: Towards a Lightweight Serverless Framework Supporting Modern AI-Driven App Development' has been accepted for presentation at the international conference on software engineering, ENASE 2024."},"CHOKAIGI2024":{"title":"Epics DAO Exhibits at CHOKAIGI 2024","description":"Epics DAO exhibited at CHOKAIGI 2024, held on April 27th - 28th, 2024, distributing limited edition NFTs and more. With a total attendance of 125,362 visitors, the event concluded successfully."},"WebX2024":{"title":"Epics DAO is a WebX 2024 Sponsor","description":"WebX 2024 is the largest event in Asia focused on cutting-edge technologies in Web3, including cryptocurrencies and blockchain. It is the only conference where government bodies, established companies, IP firms, and Web3 businesses can interact."}},"SolvTutorialYouTubeRow":{"title":"Complete Guide to Solana Validators","subtitle":"YouTube Tutorial","description":"We have released a comprehensive guide to easily start operating a Solana validator using solv. For those already running a Solana validator, you can easily switch to solv to benefit from no-downtime transitions and accelerated snapshot downloads."},"SolanaBreakpointSideEventRow":{"title":"Solana Validator Hands-On Workshop","description":"Join us to explore the realm of Solana Validators! This beginner-friendly workshop allows you to launch a Solana Validator using Latitude's cloud servers. Validators process transactions and secure the network, earning rewards. You'll get hands-on experience, unraveling the operational essence of validators while enjoying event-exclusive free credits. It's a chance to learn, interact, and dive into the incentivized world of Solana Validators. Looking forward to engaging in discussions. See you there!","link":"Event Detail"},"LatitudeCouponRow":{"subtitle":"Try it now on Bare Metal Cloud","title":"Latitude Trial Credit Coupon","description":"Through our partnership with Latitude, we are now able to offer a $100 credit coupon. By utilizing this coupon, you can actually try out launching a Solana validator with solv at hand right now.","register":"Register Coupon","couponCode":"Coupon Code"},"StakeForOpenSourceRow":{"subtitle":"Stake for the future of Open-Source Development","title":"Let's support Open-Source Development while earning staking rewards.","description":"‚Äª These are not intended for investment advice. The information are based on the situation at the time of writing. Please check for the most current information. Always NFA/DYOR.","feature1":{"title":"Solana Mainnet Validator","description":"Epics DAO operates a Solana mainnet validator with a 0% fee for users who stake their SOL tokens, resulting in a stake reward with an annual percentage rate (APR) of 7.58% as of May 16, 2024. To contribute to the decentralization of the Solana network and enable innovation worldwide, we will focus our operations in areas with fewer nodes and data centers.","button":"Go to Validator Detail"},"feature2":{"title":"Buidlers Collective (BDLC) NFT","description":"When you stake BDLC NFTs on the Epics platform, you can earn $EPCT token rewards. Additionally, an equivalent amount of $EPCT is donated to the open-source project where the NFTs are staked, to be used for future development. This initiative utilizes blockchain technology to enable socially beneficial NFT staking and No Loss Donation, where staking rewards are donated without losing the principal.","button":"Go to NFT Marketplace"}},"NicoNicoChoKaigi2024Row":{"subtitle":"Cho Dice Roll in NICONICO CHOKAIGI 2024","title":"Thank you for visiting!","description":"Epics DAO participated in Nico Nico Chokaigi 2024, held at Makuhari Messe on April 27th and 28th, and distributed limited edition NFTs to visitors. The event attracted a total of 125,362 attendees, with about 3,000 people visiting the Epics DAO Cho Dice Roll booth, successfully concluding the event with great fanfare."},"WebX2024Row":{"title":"WebX 2024 Sponsor Confirmed","description":"Epics DAO will participate as a sponsor at WebX 2024. WebX is the largest event in Asia focused on cutting-edge technologies in Web3, including cryptocurrencies and blockchain. It is the only conference where government bodies, established companies, IP firms, and Web3 businesses can interact.","discountLink":"Sponsor Discount Tickets"}},"doc":{"title":"solv Document","body":"Open-Source Solana Validator Utility Tool","previousPage":"Previous page","nextPage":"Next page","actions":{"motivation":{"title":"Motivation","body":"We believe it to be beneficial for all Solana validators, as well as the Solana community and the open-source development community, and have released it as open-source accordingly."},"quickstart":{"title":"Quickstart","body":"Learn to use solv in three easy steps! This guide quickly introduces you to the essentials of the solv."},"tutorial":{"title":"Tutorial","body":"A guide to actually starting the operation of a Solana validator using solv."},"update":{"title":"No Downtime Update","body":"Explains how to migrate validator nodes without downtime. It's effective for daily updates as well as moving operations."}},"menuNav":{"home":"Docs Home","general":{"groupTitle":"General","motivation":"Motivation","quickstart":"Quickstart"},"quickstart":{"groupTitle":"Quickstart","start-solv":"Start solv","solv-mev-mode":"solv MEV Mode","no-downtime-update":"No Downtime Update"},"tutorial":{"groupTitle":"Tutorial","chapter1":"1. Solana Setup","chapter2":"2. Backup \u0026 Migrate","chapter3":"3. Cloud \u0026 Monitor","chapter4":"4. Revenue Analysis","chapter5":"5. Setup RPC Node"}},"headerNav":{"home":"solv Home","news":"News"}}}},"initialLocale":"en","ns":["common","doc"],"userConfig":{"i18n":{"defaultLocale":"en","locales":["en","ja"]},"default":{"i18n":{"defaultLocale":"en","locales":["en","ja"]}}}}},"__N_SSG":true},"page":"/[locale]/doc/[...slug]","query":{"locale":"en","slug":["tutorial","chapter4"]},"buildId":"Po52uJGQ0M3xsRHnuxKeM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>